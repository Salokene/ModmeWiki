# How to add progress bar (like buildable progress, reviving)
Game Modding | Call of Duty: Black Ops 3 | Scripting

---
<strong style="font-size: 1.4em;"><span style="text-decoration: underline;text-decoration-color: #34a7f9;"><span style="color:#34a7f9;">ModmeBot</span></span>:</strong>

<p>Thread By: Frost Iceforge<br />I was going to make things such as buildable tables or ammo/item drops that you would hold down F to interact with that would take a certain amount of time, say 3 seconds. How do I display a bar showing the remaining time?</p>

---
<strong style="font-size: 1.4em;"><span style="text-decoration: underline;text-decoration-color: #34a7f9;"><span style="color:#34a7f9;">ModmeBot</span></span>:</strong>

<p>Reply By: KillJoyYT<br />I&#39;m probably not much help but I know archaicvirus&#39;s buildable script can be edited for something else<br /> <br /><a href="https://www.ugx-mods.com/forum/index.php?topic=15031.0">https://www.ugx-mods.com/forum/index.php?topic=15031.0</a></p>

---
<strong style="font-size: 1.4em;"><span style="text-decoration: underline;text-decoration-color: #34a7f9;"><span style="color:#34a7f9;">ModmeBot</span></span>:</strong>

<p>Reply By: NoScopeNinja25<br />I used the progress bar from the craftables script and edited out the things that check for craftable parts<br /> <br />Here is my edited code if you want to use it.  There is a variable for the radius, craft time, and the text on the progress bar.  I included comments where the triggers go and where the variables are.  It also plays the build fx and craftable sounds.  Code to edit has <strong>EDIT THIS</strong> next to part you need to edit in comments just search for those comments.<br /> <br />Make sure these are included at the top of your file, there may be more:<br />[CODE=php]#using scripts\zm\_zm_utility;<br />#using scripts\zm\_zm_weapons;<br />#using scripts\shared\laststand_shared;<br />#using scripts\shared\util_shared;<br /><br />#insert scripts\zm\craftables\_zm_craftables.gsh;<br />#using scripts\zm\craftables\_zm_craftables;[/CODE]<br /> <br />This part goes in your function that waits for the bar to fill up:<br /><br />
[CODE=php]function example()<br />{<br />    // Setup trigger here<br />    // example_trig = GetEnt(&quot;example_trig_name&quot;,&quot;targetname&quot;);<br /><br />    do<br />    {<br />        // ====================================================================================<br />        // EDIT THIS<br />    	example_trig waittill(&quot;trigger&quot;, player);    // Change example_trig to your trigger<br />        // ====================================================================================<br />    	result = self craftable_use_hold_think_override( player );<br />    } while(!result);<br /><br />    player PlaySound( &quot;zmb_craftable_complete&quot; );<br /><br />    // Code to run after progress bar is successful<br />}[/CODE]<br />
<br /><br /> <br />This is all the functions that handle the progress bar:<br /><br />
[CODE=php]function craftable_use_hold_think_override( player )<br />{<br />	self thread zm_craftables::craftable_play_craft_fx( player );<br />	self thread craftable_use_hold_think_internal_override( player );<br />	retval = self util::waittill_any_return( &quot;craft_succeed&quot;, &quot;craft_failed&quot; );<br /><br />	if ( retval == &quot;craft_succeed&quot; )<br />	{<br />		return true;<br />	}<br /><br />	return false;<br />}<br /><br />function craftable_use_hold_think_internal_override( player )<br />{<br />	wait(0.01);<br /><br />	if ( !isdefined( self ) )<br />	{<br />		//make sure the audio sounds go away<br />		if ( isdefined( player.craftableAudio ) )<br />		{<br />			player.craftableAudio delete();<br />			player.craftableAudio = undefined;<br />		}<br /><br />		return;<br />	}<br />	<br />	if ( !isdefined( self.useTime ) )<br />	{<br />		// ====================================================================================<br />		// (Optional) EDIT THIS<br />		self.useTime = int( 3 * 1000 );		// This sets the craft time - in miliseconds 3 * 1000 = 3000 miliseconds or 3 seconds<br />		// ====================================================================================<br />	}<br /><br />	self.craft_time = self.useTime;<br />	self.craft_start_time = getTime();<br />	craft_time = self.craft_time;<br />	craft_start_time = self.craft_start_time;<br /><br />	if ( craft_time &gt; 0 )<br />	{<br />	    player zm_utility::disable_player_move_states( true );<br /><br />		player zm_utility::increment_is_drinking();<br />		orgweapon = player GetCurrentWeapon();<br />		build_weapon = GetWeapon( &quot;zombie_builder&quot; );<br />		player GiveWeapon( build_weapon );<br />		player SwitchToWeapon( build_weapon );<br /><br />		player thread zm_craftables::player_progress_bar( craft_start_time, craft_time );<br /><br />		while ( isdefined( self ) &amp;&amp; player player_continue_crafting_override() &amp;&amp; getTime() - self.craft_start_time &lt; self.craft_time )<br />		{<br />			wait(0.01);<br />			if ( isdefined( player ) &amp;&amp; !isdefined( player.craftableAudio ) )<br />			{<br />				player.craftableAudio = spawn( &quot;script_origin&quot;, player.origin );<br />				player.craftableAudio PlayLoopSound( &quot;zmb_craftable_loop&quot; );<br />			}<br />		}<br /><br />		//make sure the audio sounds go away<br />		if ( isdefined( player.craftableAudio ) )<br />		{<br />			player.craftableAudio delete();<br />			player.craftableAudio = undefined;<br />		}<br /><br />		player notify( &quot;craftable_progress_end&quot; );<br /><br />		player zm_weapons::switch_back_primary_weapon( orgweapon );<br />		//player SwitchToWeapon( orgweapon );<br />		player TakeWeapon( build_weapon );<br /><br />		if ( IS_TRUE( player.is_drinking ) )<br />		{<br />			player zm_utility::decrement_is_drinking();<br />		}<br /><br />		player zm_utility::enable_player_move_states();<br />	}<br /><br />	if ( isdefined( self ) &amp;&amp;<br />	        player player_continue_crafting_override() &amp;&amp;<br />	        ( self.craft_time &lt;= 0 || getTime() - self.craft_start_time &gt;= self.craft_time ) )<br />	{<br />		self notify( &quot;craft_succeed&quot; );<br />	}<br />	else<br />	{<br />		//make sure the audio sounds go away<br />		if ( isdefined( player.craftableAudio ) )<br />		{<br />			player.craftableAudio delete();<br />			player.craftableAudio = undefined;<br />		}<br /><br />		self notify( &quot;craft_failed&quot; );<br />	}<br />}<br /><br />function player_continue_crafting_override()<br />{<br />	if ( self laststand::player_is_in_laststand() || self zm_utility::in_revive_trigger() )<br />	{<br />		return false;<br />	}<br /><br />	if ( isdefined( self.screecher ) )<br />	{<br />		return false;<br />	}<br /><br />	if ( !self UseButtonPressed() )<br />	{<br />		return false;<br />	}<br /><br />	// ====================================================================================<br />	// EDIT THIS<br />	trigger = GetEnt(&quot;camo_button_empty_trig&quot;,&quot;targetname&quot;);	// Change camo_button_empty_trig to the tagrgetname of your trigger<br />	script_unitrigger_type = &quot;unitrigger_radius_use&quot;;			// If you change this to anything else it will check to see if the player is still touching the trigger instead of checking radius<br />	radius = 40;												// Radius from trigger to cancel progress bar<br />	// ====================================================================================<br /><br />	if ( script_unitrigger_type == &quot;unitrigger_radius_use&quot; )<br />	{<br />		torigin = trigger.origin;<br />		porigin = self GetEye();<br />		radius_sq = ( 1.5 * 1.5 ) * radius * radius;<br /><br />		if ( Distance2DSquared( torigin, porigin ) &gt; radius_sq )<br />		{<br />			return false;<br />		}<br />	}<br />	else<br />	{<br />		if ( !isdefined( trigger ) || !trigger IsTouching( self ) ) //self IsTouching(trigger))<br />		{<br />			return false;<br />		}<br />	}<br /><br />	if (!self util::is_player_looking_at( trigger.origin, ZM_CRAFTABLES_LOOKAT_DOT ) )<br />	{<br />		return false;<br />	}<br /><br />	return true;<br />}[/CODE]<br />
<br /><br /> <br />If you want to change the text above the bar add this:<br /><br />
[CODE=php]function player_progress_bar_override( start_time, craft_time )<br />{<br />    self.useBar = self hud::createPrimaryProgressBar();<br />    self.useBarText = self hud::createPrimaryProgressBarText();<br /><br />    // ====================================================================================<br />    // EDIT THIS<br />    self.useBarText setText( &amp;&quot;ZOMBIE_BUILDING&quot; );    // Remove the &amp; symbol and replace ZOMBIE_BUILDING with text<br />    // ====================================================================================<br /><br />    if ( isdefined( self ) &amp;&amp; isdefined( start_time ) &amp;&amp; isdefined( craft_time ) )<br />    {<br />        self zm_craftables::player_progress_bar_update( start_time, craft_time );<br />    }<br /><br />    self.useBarText hud::destroyElem();<br />    self.useBar hud::destroyElem();<br />}[/CODE]<br />
<br /><br /> <br />Replace any &quot;zm_craftables::player_progress_bar&quot; with this &quot;player_progress_bar_override&quot;<br />If you want to remove the fx delete/comment out this:<br />[CODE=php]self thread zm_craftables::craftable_play_craft_fx( player );[/CODE]<br /> <br />If you want to remove the sounds delete/comment out these:<br />[CODE=php]player.craftableAudio PlayLoopSound( &quot;zmb_craftable_loop&quot; );<br />AND<br />player PlaySound( &quot;zmb_craftable_complete&quot; );[/CODE]</p>

---
<strong style="font-size: 1.4em;"><span style="text-decoration: underline;text-decoration-color: #34a7f9;"><span style="color:#34a7f9;">ModmeBot</span></span>:</strong>

<p>Reply By: mathfag<br />Here&#39;s what I used in a generator script. It shouldn&#39;t be too hard to see what you need.<br /> <br />[CODE=php]		width = 300;<br />		height = 100;<br /><br />		trigr = Spawn(&quot;trigger_radius&quot;, self.origin, 0, width, height);<br />		prog = Float(0.0);<br /><br />		players = GetPlayers();<br /><br />		foreach(player in players)<br />			{<br />			if(player IsTouching(trigr))<br />				{<br />				self.hackProgressBar = player hud::createPrimaryProgressBar();<br />				self.hackProgressText = player hud::createPrimaryProgressBarText();<br />				self.hackProgressBar hud::updateBar( 0.0, 0.0 );<br />				self.hackProgressBar hud::showElem();<br />				self.hackProgressText hud::showElem();<br />				self.hackProgressText SetText(&quot;Powering generator at &quot;+location);<br />				}<br />			}<br />		self PlaySound(&quot;gen_start&quot;);<br />		wait(0.05);<br />		self thread gen_sound();<br /><br />		trigr waittill(&quot;trigger&quot;, player);<br />		while(1)<br />			{<br />				if(player IsTouching(trigr))<br />					{<br />					prog+= Float(0.005);	<br />					self.hackProgressBar hud::updateBar( prog, 0.0 );<br />					}<br />	//hud::updateBar(barFrac, rateOfChange)<br />				else<br />					{<br />					prog-= Float(0.01);<br />					self.hackProgressBar hud::updateBar( prog, 0.0 );<br />					}<br /><br />				//IPrintLnBold(prog);<br />				if(prog &lt;= 0)<br />					{<br />					self.hackProgressBar hud::destroyElem();<br />					self.hackProgressText hud::destroyElem();<br />					self StopLoopSound(1);<br />					PlaySoundAtPosition(&quot;gen_fail&quot;,self.origin);<br />					//IPrintLnBold(&quot;failed&quot;);<br />					thread do_gens(location);	<br />					break;<br />					}<br /><br />				if(prog &gt;= 1)<br />					{<br />					self.hackProgressBar hud::destroyElem();<br />					self.hackProgressText hud::destroyElem();<br />					self StopLoopSound(1);<br />					PlaySoundAtPosition(&quot;gen_succeed&quot;,self.origin);<br />					foreach(player in GetPlayers())<br />						{<br />						if(player IsTouching(trigr))<br />							player zm_score::add_to_player_score(gen_cost*2);<br /><br />						}<br />					//IPrintLnBold(&quot;complete&quot;);<br />					prog = 2;<br />					break;<br />					}<br />				<br />			wait(0.05);<br />			}[/CODE]</p>
